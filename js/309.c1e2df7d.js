(window.webpackJsonp=window.webpackJsonp||[]).push([[309],{937:function(n,e){n.exports="\x3c!--\ntitle: 41-电子邮件\nsort:\n--\x3e\n\n# 电子邮件\n\n## yagmail\n\n> 不要妄想用内置库,快使用 yagmail 吧 🤣\n\n```python\nimport yagmail\n\n#链接邮箱服务器\nyag = yagmail.SMTP( user=\"user@126.com\", password=\"1234\", host='smtp.126.com')\n\n# 邮箱正文\ncontents = ['This is the body, and here is just text http://somedomain/image.png',\n            'You can find an audio file attached.', '/local/path/song.mp3']\n\n# 发送邮件\nyag.send('taaa@126.com', 'subject', contents)\n# 关闭\nyag.close()\n```\n\n### 附加\n\n```python\n# 多个用户发邮件\nyag.send(['aa@126.com','bb@qq.com','cc@gmail.com'], 'subject', contents)\n# 带附件\nyag.send('aaaa@126.com', '发送附件', contents, [\"d://log.txt\",\"d://baidu_img.jpg\"])\n```\n\n### SMTP 发送邮件\n\n🚦 踩了好多坑，在也不想用内置库发邮件了\n\n> SMTP 是发送邮件的协议，Python 内置对 SMTP 的支持，可以发送纯文本邮件、HTML 邮件以及带附件的邮件。\n\n```python\nfrom email.mime.text import MIMEText\n\nimport smtplib\n\nuser_addr = ''\t\t# 发送账户\npassword = ''\t\t# 授权码\nto_addr = ''\t\t# 接收账户\nsmtp_server = ''\t# 代理商服务器\n\nmsg = MIMEText('send by python.', 'plain', 'utf-8')\t# 设置信息\nmsg['Subject'] = 'test_mail'\t\t# 必须设置，否则554错误\nmsg['from'] = 'xx@163.com'\nmsg['to'] = 'xx@qq.com'\n\nserver = smtplib.SMTP(smtp_server, 25)\t# 设置server服务器\nserver.set_debuglevel(0)\t\t\t# debug专用\nserver.login(user_addr, password)\t# 登录STMP服务器\n# 成败在此一举啦\nserver.sendmail(user_addr, [to_addr], msg.as_string())\nserver.quit()\t# 退出\n\n```\n\n- 更加完整的邮件\n\n  ```python\n  from email import encoders\n  from email.header import Header\n  from email.mime.text import MIMEText\n  from email.utils import parseaddr, formataddr\n\n  def _format_addr(s):\t\t# 格式化发送人\n      name, addr = parseaddr(s)\n      return formataddr((Header(name, 'utf-8').encode(), addr))\n\n  msg = MIMEText('hello, send by Python...', 'plain', 'utf-8')\n  msg['From'] = _format_addr('Python爱好者 <%s>' % from_addr)\n  msg['To'] = _format_addr('管理员 <%s>' % to_addr)\n  msg['Subject'] = Header('来自SMTP的问候……', 'utf-8').encode()\n  ```\n\n- 携带附件\n\n  ```python\n  from email.mime.text import MIMEText\n  from email.mime.base import MIMEBase\n  from email.mime.multipart import MIMEMultipart\n  from email import encoders\n\n  msg = MIMEMultipart()\n  msg.attach(MIMEText('send with file...', 'plain', 'utf-8'))\n\n  # 添加附件就是加上一个MIMEBase，从本地读取一个图片:\n  with open(\"E:\\My_Project\\图库\\\\avatar.jpg\", 'rb') as f:\n      # 设置附件的MIME和文件名，这里是png类型:\n      mime = MIMEBase('image', 'jpg', filename='头像.png')\n      # 加上必要的头信息:\n      mime.add_header('Content-Disposition', 'attachment', filename='头像.png')\n      mime.add_header('Content-ID', '<0>')\n      mime.add_header('X-Attachment-Id', '0')\n      # 把附件的内容读进来:\n      mime.set_payload(f.read())\n      # 用Base64编码:\n      encoders.encode_base64(mime)\n      # 添加到MIMEMultipart:\n      msg.attach(mime)\n\n  ```\n"}}]);