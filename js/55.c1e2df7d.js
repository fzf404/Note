(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{683:function(n,a){n.exports='\x3c!--\ntitle: 02-Ajax入门\nsort:\n--\x3e\n\n## load\n\n```js\nvar text1 = $("#text1");\nvar text2 = $("#text2");\nvar text3 = $("#text3");\nvar info = $("#info");\n\n// 加载\ninfo.load("card.html");\n// 使用load发送get请求\ntext2.load("/api/getdata?name=gdy");\n// 使用load发送Post请求\ntext3.load("/api/getjson", { data: "bili" });\n```\n\n> 异步加载\n\n```js\nvar trigger = $("#trigger");\nvar card = $("#card");\nvar loaded;\n// 点击trigger触发加载\ntrigger.click(() => {\n  // 如果visable，缓出\n  if (card.is(":visible")) {\n    card.slideUp();\n  } else {\n    if (!loaded) {\n      card.load("card.html");\n      loaded = true;\n    }\n    card.slideDown();\n  }\n});\n```\n\n## 其他方法\n\n```js\n// get方法\n$.get(`${base_url}/total`, (data) => {\n  // 解析json\n  if (typeof json == "string") {\n    json = JSON.parse(data);\n  }\n}).fail(() => {});\n\n// post方法\n$.post(`${base_url}/new`, data, (json) => {}).fail(() => handle_fail());\n```\n\n## ajax\n\n```js\n// form-data 格式\n$.ajax({\n  type: "post",\n  url: `${base_url}/login`,\n  data: {\n    username: "fzf",\n    password: "password",\n  },\n  success: (data) => {},\n  error: () => {},\n});\n\n// json格式\n$.ajax({\n  type: "post",\n  url: `${base_url}/update`,\n  contentType: "application/json",\n  dataType: "json",\n  data: JSON.stringify(data),\n\n  // 成功处理\n  success: (data) => {},\n  // 失败处理\n  error: () => {},\n});\n\n// 上传图片\n$("#uploadimg").on("change", (event) => {\n  // console.log(event.target.files[0].name);\n  var uploadURL = "/api/upimg";\n  var formData = new FormData();\n  formData.append("img", event.target.files[0]);\n  // ajax上传图片\n  $.ajax(uploadURL, {\n    method: "POST",\n    data: formData,\n    contentType: false,\n    processData: false,\n    beforeSend: (xhr) => {\n      token = window.localStorage.getItem("token");\n      xhr.setRequestHeader("Authorization", "Bearer " + token);\n    },\n    // 得到响应的处理\n    success: (data) => {},\n    // 未响应的处理\n    error: () => {},\n  });\n});\n```\n\n## Token\n\n> Bearer\n\n```js\n// 存储Token\nwindow.localStorage.setItem("token", data.data.token);\n// 获取token\nwindow.localStorage.getItem("token");\n\n// ajax请求\n$.ajax(myinfoURL, {\n  method: "POST",\n  // 设置请求头\n  beforeSend: (req) => {\n    token = window.localStorage.getItem(\'token\')\n    req.setRequestHeader(\'x-token\', token)\n  },\n  success: () => {},\n});\n```\n'}}]);