(window.webpackJsonp=window.webpackJsonp||[]).push([[264],{892:function(n,e){n.exports="\x3c!--\ntitle: SQL\nsort:\n--\x3e\n\n# SQL\n\n## 使用\n\n```mysql\n~$ mysql -uroot -p\nmysql> select version();\t# 版本信息\nmysql> select now();\t\t# 当前时间\nmysql> exit\t\t# 退出\n\n# 数据库操作\nmysql> select database();\t\t# 显示当前使用数据库\nmysql> show databases;\t\t# 查看所有数据库\nmysql> create database fzf_db charset=utf8;\t# 新建\nmysql> use fzf_db;\t\t# 切换数据库\nmysql> show create database fzf_db;\t=# 数据库信息\nmysql> drop database zf_db;\t\t# 删除数据库\n\n# 表操作\nmysql> show tables；\n# 新建表\nmysql> create table fzf(\n    -> name varchar(10) not null,\n    -> id int unsigned primary key auto_increment,\n    # 字段名\t数据类型\t\t主键\t\t自动增加\n    -> age tinyint\n    -> );\n# 查看表结构\nmysql> desc fzf;\nmysql> show create table fzf;\n# 修改表结构\nmysql> alter table fzf add sex enum('man','woman');\t# 增加\nmysql> alter table fzf add birt datetime;\nmysql> alter table fzf change birt birth datetime;\t# 重命名\nmysql> alter table fzf modify birth datetime not null;\t\t# 修改字段\nmysql> alter table fzf drop birth;\t\t# 删除字段\n\n# 数据操作\n\n# Insert\t插入\nmysql> insert into fzf values('fzf',1,18,'man');\nmysql> insert into fzf(id, name) values(null,'cnm');\nmysql> insert into fzf values('fzf3',null,15,'man'),('fzf4',null,13,'woman');\n+------+----+------+-------+\n| name | id | age  | sex   |\n+------+----+------+-------+\n| fzf  |  1 |   18 | man   |\n| cnm  |  2 | NULL | NULL  |\n| fzf2 |  3 |   16 | man   |\n| fzf3 |  4 |   15 | man   |\n| fzf4 |  5 |   13 | woman |\n+------+----+------+-------+\n\n# Update \t更新\nmysql> update fzf set sex='man';\t# 全部设置\nmysql> update fzf set sex='woman' where name='fzf4';\t# 部分更新\n+------+----+------+-------+\n| name | id | age  | sex   |\n+------+----+------+-------+\n| fzf  |  1 |   18 | man   |\n| cnm  |  2 | NULL | man   |\n| fzf2 |  3 |   16 | man   |\n| fzf3 |  4 |   15 | man   |\n| fzf4 |  5 |   13 | woman |\n+------+----+------+-------+\n\n# Select 选择\nmysql> select * from fzf;\t# 查看表内容\nmysql> select id,name from fzf;\nmysql> select id as '编号', name as '姓名' from fzf;\t# 别名\n+--------+--------+\n| 编号   | 姓名    |\n+--------+--------+\n|      1 | fzf    |\n|      2 | cnm    |\n|      3 | fzf2   |\n|      4 | fzf3   |\n|      5 | fzf4   |\n+--------+--------+\nmysql> select * from students where age>13;\n\n# delete \t删除\nmysql> delete from fzf where name='cnm';\n\n# 导入导出\n$ mysqldump -uroot -p fzf_db > fzf_db1.sql\n\n```\n\n### where\n\n```mysql\n# Where\n# 模糊查询\n% 任意字符\n_ 单个字符\nmysql> select * from students where name like '小%';\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00                 |\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00                 |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n\nmysql> select * from students where age in (13,14);\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00                 |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n\nmysql> select * from students where age between 13 and 14;\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00                 |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n\nmysql> select * from students where age not between 13 and 14;\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n\n```\n\n### 排序\n\n```mysql\n# 排序\n# asc 升序 desc 降序\nmysql> select * from students where gender=1 order by age desc;\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00                 |\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n\nmysql> select * from students order by age desc,height asc;\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00                 |\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00                 |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n```\n\n### 聚合函数\n\n```mysql\n# 聚合函数\ncount(*)\t# 计算总行数\nmysql> select count(*) '总人数' from students;\n+-----------+\n| 总人数    |\n+-----------+\n|         4 |\n+-----------+\nmysql> select count(*) from students where gender='男';\n+----------+\n| count(*) |\n+----------+\n|        2 |\n+----------+\n\nmax() min()\t\t# 最大/小值\nmysql> select max(age) from students;\n+----------+\n| max(age) |\n+----------+\n|       15 |\n+----------+\n\nsum()\t\t# 求和\n# 平均年龄\nmysql> select sum(age)/count(*) from students;\n+-------------------+\n| sum(age)/count(*) |\n+-------------------+\n|           14.0000 |\n+-------------------+\navg()\t# 平均数\nround(num,digits)\t# 保留位数\n\n```\n\n### 分组\n\n```mysql\n# group 分组\ngroup by\t# 分组\nmysql> select gender from students group by gender;\n+--------+\n| gender |\n+--------+\n| 男     |\n| 女     |\n| LGBT   |\n+--------+\nmysql> select gender,count(*) from students group by gender;\n+--------+----------+\n| gender | count(*) |\n+--------+----------+\n| 男     |        2 |\n| 女     |        1 |\n| LGBT   |        1 |\n+--------+----------+\nmysql> select age,count(*) from students group by age;\n+------+----------+\n| age  | count(*) |\n+------+----------+\n|   14 |        2 |\n|   13 |        1 |\n|   15 |        1 |\n+------+----------+\nmysql> select gender,max(age) from students where gender='男' or gender='女' group by gender;\n+--------+----------+\n| gender | max(age) |\n+--------+----------+\n| 男     |       15 |\n| 女     |       13 |\n+--------+----------+\n# 包含\nmysql> select gender,group_concat(name) from students group by gender;\n+--------+--------------------+\n| gender | group_concat(name) |\n+--------+--------------------+\n| 男     | 小明,小刚          |\n| 女     | 小红               |\n| LGBT   | 小齐               |\n+--------+--------------------+\nmysql> select gender,avg(age) from students group by gender;\n+--------+----------+\n| gender | avg(age) |\n+--------+----------+\n| 男     |  14.5000 |\n| 女     |  13.0000 |\n| LGBT   |  14.0000 |\n+--------+----------+\n# having\nmysql> select gender,avg(age) from students group by gender having avg(age) >= 14;\n+--------+----------+\n| gender | avg(age) |\n+--------+----------+\n| 男     |  14.5000 |\n| LGBT   |  14.0000 |\n+--------+----------+\n# 设置别名\nmysql> select gender,avg(age) av from students group by gender having avg(age) >= 14;\n+--------+---------+\n| gender | av      |\n+--------+---------+\n| 男     | 14.5000 |\n| LGBT   | 14.0000 |\n+--------+---------+\nmysql> select gender,count(*),avg(age)from students group by gender;\n+--------+----------+----------+\n| gender | count(*) | avg(age) |\n+--------+----------+----------+\n| 男     |        2 |  14.5000 |\n| 女     |        1 |  13.0000 |\n| LGBT   |        1 |  14.0000 |\n+--------+----------+----------+\n# with rollup 合计\nmysql> select gender,count(*) from students group by gender with rollup;\n+--------+----------+\n| gender | count(*) |\n+--------+----------+\n| 男     |        2 |\n| 女     |        1 |\n| LGBT   |        1 |\n| NULL   |        4 |\n+--------+----------+\n\n# limit begin, len\nmysql> select gender,count(*) from students group by gender limit 0,1;\n+--------+----------+\n| gender | count(*) |\n+--------+----------+\n| 男     |        2 |\n+--------+----------+\nmysql> select * from students limit 0,3;\n+----+--------+------+--------+--------+----------------------+\n| id | name   | age  | height | gender | ts_delete            |\n+----+--------+------+--------+--------+----------------------+\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00                 |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00                 |\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00                 |\n+----+--------+------+--------+--------+----------------------+\n```\n\n### 连接查询\n\n```mysql\njoin on\n# 将一个表中断内容连接至另一表\n\nmysql> select * from students inner join classes;\n+----+--------+------+--------+--------+-------------+----+----------+\n| id | name   | age  | height | gender | ts_delete   | id | name     |\n+----+--------+------+--------+--------+-------------+----+----------+\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00        |  1 | fire     |\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00        |  2 | sunshine |\n|  1 | 小明   |   14 | 162.00 | 男     | 0x00        |  3 | create   |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00        |  1 | fire     |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00        |  2 | sunshine |\n|  3 | 小红   |   13 | 152.00 | 女     | 0x00        |  3 | create   |\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00        |  1 | fire     |\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00        |  2 | sunshine |\n|  4 | 小刚   |   15 | 165.00 | 男     | 0x00        |  3 | create   |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00        |  1 | fire     |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00        |  2 | sunshine |\n|  5 | 小齐   |   14 | 163.00 | LGBT   | 0x00        |  3 | create   |\n+----+--------+------+--------+--------+-------------+----+----------+\nmysql> select s.name,s.id from students s inner join classes;\n+--------+----+\n| name   | id |\n+--------+----+\n| 小明   |  1 |\n| 小明   |  1 |\n| 小明   |  1 |\n| 小红   |  3 |\n| 小红   |  3 |\n| 小红   |  3 |\n| 小刚   |  4 |\n| 小刚   |  4 |\n| 小刚   |  4 |\n| 小齐   |  5 |\n| 小齐   |  5 |\n| 小齐   |  5 |\n+--------+----+\n```\n\n### 子查询\n\n```mysql\n# 嵌套查询\nselect * from students where age > ( select avg(age) from students);\n# 查询年龄大于平均值的人\n+----+--------+------+--------+--------+------------------+\n| id | name   | age  | height | gender | ts_delete        |\n+----+--------+------+--------+--------+------------------+\n|  4 | 小刚   |    15 | 165.00 | 男      | 0x00            |\n+----+--------+------+--------+--------+------------------+\n```\n\n### 练习\n\n```sql\n create table students(\n id int unsigned primary key auto_increment not null ,\n name varchar(20) default '',\n age tinyint unsigned default 0,\n height decimal(5,2),\n gender enum('男','女','保密','LGBT') default '保密' ,\n ts_delete bit default 0\n );\n\n create table classes(\n id int unsigned primary key auto_increment not null ,\n name varchar(30) not null\n );\n\n insert into students values\n (0,'小明',14,162.00,1,0),\n (0,'小红',13,152.00,2,0),\n (0,'小刚',15,165.00,1,0),\n (0,'小齐',14,163.00,4,0)\n ;\n\n select s.id,s.name from students as s;\n +----+--------+\n | id | name   |\n +----+--------+\n |  1 | 小明   |\n |  3 | 小红   |\n |  4 | 小刚   |\n |  5 | 小齐   |\n +----+--------+\n```\n\n## 数据完整性\n\n### 实体完整性\n\n> 主键约束：不能为空，也不能重复 primary key\n>\n> 唯一约束：可以为空，不能重复：unique key\n\n### 域完整约束\n\n> 非空约束：不能为空 not null\n>\n> 默认约束：default\n\n### 参照完整性\n\n> 外键约束：建立表与主键的关系 foreign key\n\n## 数据类型\n\n1. ### 整型\n\n   | 数据类型        | 存储(bytes)                                      | 值                                       |\n   | :-------------- | :----------------------------------------------- | ---------------------------------------- |\n   | TINYINT(size)   | 1                                                | -128_127                                 |\n   | SMALLINT(size)  | 2                                                | -32768_32767                             |\n   | MEDIUMINT(size) | 3                                                | -8388608_8388607                         |\n   | INT(size)       | 4                                                | -2147483648_2147483647                   |\n   | BIGINT(size)    | 8                                                | -9223372036854775808_9223372036854775807 |\n   | FLOAT(size,d)   | 4                                                | 总位数最大值，小数位最大值               |\n   | DOUBLE(size,d)  | 8                                                |                                          |\n   | DECIMAL(size,d) | 作为字符串存储的 DOUBLE 类型，允许固定的小数点。 |                                          |\n   | enum(options)   |                                                  |                                          |\n"}}]);