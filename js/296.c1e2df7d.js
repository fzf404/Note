(window.webpackJsonp=window.webpackJsonp||[]).push([[296],{924:function(n,i){n.exports="\x3c!--\ntitle: 23-Pywin32\nsort:\n--\x3e\n\n```python\nimport win32gui\nimport win32con\n\n# FindWindow(窗体类名, 窗口名) 返回窗口句柄\nwin = win32gui.FindWindow('Notepad', '无标题 - 记事本')\n# 返回Edit子窗口句柄\ntid = win32gui.FindWindowEx(win, None, 'Edit', None)\n\n# SendMessage(窗口句柄,发送方式,类型,信息) 发送消息\nwin32gui.SendMessage(tid, win32con.WM_SETTEXT, None, 'hello word!')\nwin32gui.PostMessage(tid, win32con.WM_KEYDOWN, win32con.VK_RETURN, 0)\n```\n\n### 实战\n\n```python\nimport win32gui\nimport win32con\nimport win32clipboard as cb\nimport time\n\ndef send(name, msg):\n    cb.OpenClipboard()    # 打开剪贴板\n    cb.SetClipboardData(win32con.CF_UNICODETEXT, msg)       # 设置剪贴板内容\n    # cb.GetClipboardData() # 获取剪贴板内容\n    # cb.EmptyClipboard()   # 清空剪贴板\n    cb.CloseClipboard()     # 关闭剪贴板\n    # 获取qq窗口句柄\n    handle = win32gui.FindWindow(None, name)\n    if handle == 0:\n        print('未找到窗口！')\n    # 显示窗口\n    win32gui.ShowWindow(handle, win32con.SW_SHOW)\n    # 把剪切板内容粘贴到qq窗口\n    win32gui.SendMessage(handle, win32con.WM_PASTE, 0, 0)\n    # 按下后松开回车键，发送消息\n    win32gui.SendMessage(handle, win32con.WM_KEYDOWN, win32con.VK_RETURN, 0)\n    win32gui.SendMessage(handle, win32con.WM_KEYUP, win32con.VK_RETURN, 0)\n    time.sleep(1)  # 延缓进程\n\ndef main():\n    name = '私がでした'  # QQ聊天窗口的名字\n    print('开始')\n    for i in range(1, 6):\n        send(name, '第'+str(i)+'次测试')\n    print('结束')\n\n\nmain()\n\n```\n"}}]);